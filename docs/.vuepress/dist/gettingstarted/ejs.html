<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting Started with Chinchay + ejs | Chinchay Docs</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.ab30e0ca.css" as="style"><link rel="preload" href="/assets/js/app.23d6a0c9.js" as="script"><link rel="preload" href="/assets/js/2.6e51adde.js" as="script"><link rel="preload" href="/assets/js/21.efc1f4cc.js" as="script"><link rel="prefetch" href="/assets/js/10.c0e717ab.js"><link rel="prefetch" href="/assets/js/11.8a655531.js"><link rel="prefetch" href="/assets/js/12.ecf84a04.js"><link rel="prefetch" href="/assets/js/13.115f7382.js"><link rel="prefetch" href="/assets/js/14.83d02b0c.js"><link rel="prefetch" href="/assets/js/15.3cb7e59e.js"><link rel="prefetch" href="/assets/js/16.33a410f6.js"><link rel="prefetch" href="/assets/js/17.6a9a1f61.js"><link rel="prefetch" href="/assets/js/18.e13796e7.js"><link rel="prefetch" href="/assets/js/19.410560eb.js"><link rel="prefetch" href="/assets/js/20.49463f85.js"><link rel="prefetch" href="/assets/js/22.1c6790be.js"><link rel="prefetch" href="/assets/js/23.c4c9c93c.js"><link rel="prefetch" href="/assets/js/24.d6803a7b.js"><link rel="prefetch" href="/assets/js/25.b83209a9.js"><link rel="prefetch" href="/assets/js/26.2b451d63.js"><link rel="prefetch" href="/assets/js/27.35e5ae38.js"><link rel="prefetch" href="/assets/js/28.084b9118.js"><link rel="prefetch" href="/assets/js/29.e5ac2f45.js"><link rel="prefetch" href="/assets/js/3.13a62c78.js"><link rel="prefetch" href="/assets/js/30.b7b4033b.js"><link rel="prefetch" href="/assets/js/31.57a91f49.js"><link rel="prefetch" href="/assets/js/32.6728184c.js"><link rel="prefetch" href="/assets/js/33.4b8d7052.js"><link rel="prefetch" href="/assets/js/34.45cf8547.js"><link rel="prefetch" href="/assets/js/35.93358e11.js"><link rel="prefetch" href="/assets/js/36.168f7e6e.js"><link rel="prefetch" href="/assets/js/4.8768649f.js"><link rel="prefetch" href="/assets/js/5.ec44fb04.js"><link rel="prefetch" href="/assets/js/6.a012da5f.js"><link rel="prefetch" href="/assets/js/7.da043634.js"><link rel="prefetch" href="/assets/js/8.749a11ac.js"><link rel="prefetch" href="/assets/js/9.7144fc8a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ab30e0ca.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Chinchay Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/gettingstarted/" class="nav-link router-link-active">
  Getting Started
</a></div><div class="nav-item"><a href="/docs/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/models/" class="nav-link">
  The Model
</a></div><div class="nav-item"><a href="/middleware/" class="nav-link">
  Middleware
</a></div><div class="nav-item"><a href="https://apanotupyme.cl/pages/terminos-y-condiciones2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Error Handler
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://apanotupyme.cl/pages/terminos-y-condiciones3" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Collaborate!
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/gettingstarted/" class="nav-link router-link-active">
  Getting Started
</a></div><div class="nav-item"><a href="/docs/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/models/" class="nav-link">
  The Model
</a></div><div class="nav-item"><a href="/middleware/" class="nav-link">
  Middleware
</a></div><div class="nav-item"><a href="https://apanotupyme.cl/pages/terminos-y-condiciones2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Error Handler
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://apanotupyme.cl/pages/terminos-y-condiciones3" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Collaborate!
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/gettingstarted/ejs.html" aria-current="page" class="active sidebar-link">Getting Started</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/gettingstarted/ejs.html#getting-started-with-chinchay-ejs" class="sidebar-link">Getting Started with Chinchay + ejs</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/ejs.html#create-nodejs-app-with-express" class="sidebar-link">Create nodejs app with express</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/ejs.html#create-postgresql-database" class="sidebar-link">Create Postgresql Database</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/ejs.html#connecting-to-the-database" class="sidebar-link">Connecting to the Database</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/ejs.html#using-chinchay" class="sidebar-link">Using Chinchay</a></li></ul></li><li><a href="/gettingstarted/angular.html" class="sidebar-link">Getting Started: Chinchay + Angular</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/gettingstarted/angular.html#getting-started-with-chinchay-angular" class="sidebar-link">Getting Started with Chinchay + Angular</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/angular.html#backend-server" class="sidebar-link">Backend Server</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/angular.html#angular-app" class="sidebar-link">Angular App</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/angular.html#chinchay" class="sidebar-link">Chinchay</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/angular.html#connecting-backend-and-frontend" class="sidebar-link">Connecting Backend and Frontend</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/angular.html#running-the-app" class="sidebar-link">Running the app</a></li></ul></li><li><a href="/gettingstarted/apiMiddleware.html" class="sidebar-link">Getting Started: RESTful API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/gettingstarted/apiMiddleware.html#building-our-first-restful-api" class="sidebar-link">Building our first RESTful API</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/apiMiddleware.html#create-nodejs-app-with-express" class="sidebar-link">Create nodejs app with express</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/apiMiddleware.html#creating-the-coffee-tea-relations" class="sidebar-link">Creating the coffee + tea relations</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/apiMiddleware.html#creating-the-users" class="sidebar-link">Creating the users</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/apiMiddleware.html#getting-the-token" class="sidebar-link">Getting the token</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/apiMiddleware.html#configuring-thewall" class="sidebar-link">Configuring TheWall</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/apiMiddleware.html#configuring-access" class="sidebar-link">Configuring Access</a></li><li class="sidebar-sub-header"><a href="/gettingstarted/apiMiddleware.html#conclusion" class="sidebar-link">Conclusion</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="getting-started-with-chinchay-ejs"><a href="#getting-started-with-chinchay-ejs" class="header-anchor">#</a> Getting Started with Chinchay + ejs</h2> <p>This tutorial will walk you through building your fist app with Chinchay! We will use <a href="https://ejs.co/" target="_blank" rel="noopener noreferrer">ejs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as our templating language to you generate HTML files with plain JavaScript.</p> <h3 id="requirements"><a href="#requirements" class="header-anchor">#</a> Requirements</h3> <ul><li><a href="https://www.npmjs.com/get-npm" target="_blank" rel="noopener noreferrer">npm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://expressjs.com/" target="_blank" rel="noopener noreferrer">express<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">Postgres<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>If you do not have express installed you can easily install it with npm</p> <div class="language- extra-class"><pre class="language-text"><code>$ npm install express -g
</code></pre></div><h2 id="create-nodejs-app-with-express"><a href="#create-nodejs-app-with-express" class="header-anchor">#</a> Create nodejs app with express</h2> <p>Create a nodejs app called: test_chinchay</p> <div class="language- extra-class"><pre class="language-text"><code>$ express test_chinchay &amp;&amp; cd test_chinchay
</code></pre></div><br>
We will install drivers to use PostgresSQL database. we will use knexjs and pg
<div class="language- extra-class"><pre class="language-text"><code>$ npm install pg -s
$ npm install knex -s
</code></pre></div><br>
Also we will use ejs instead of jade. So we need to run
<div class="language- extra-class"><pre class="language-text"><code>$ npm install ejs -s
</code></pre></div><br>
Lets run the app to see what we have so far!
<div class="language- extra-class"><pre class="language-text"><code>$ npm install
$ npm start
</code></pre></div><br> <p>Visit <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">http://localhost:3000<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to see the defaut express web app</p> <h2 id="create-postgresql-database"><a href="#create-postgresql-database" class="header-anchor">#</a> Create Postgresql Database</h2> <p>In this tutorial we will not dig in how Postgres fully work. For more information on how to work around Postgres visit <a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>In order to connect to Postgres, we need to create a database. If you have postgresql installed you can run</p> <div class="language- extra-class"><pre class="language-text"><code>$ psql
</code></pre></div><br>
This should open up postgresql console. Run the following command:
<div class="language- extra-class"><pre class="language-text"><code>postgres=# CREATE DATABASE test_chinchay;
</code></pre></div><p><em>NOTE:</em> Depending on your default user and psql version the syntax of the previous line may vary.</p> <p>if its successful close psql, run:</p> <div class="language- extra-class"><pre class="language-text"><code>postgres=# \q
</code></pre></div><h2 id="connecting-to-the-database"><a href="#connecting-to-the-database" class="header-anchor">#</a> Connecting to the Database</h2> <p>In this tutorial we will not dig in how knex fully work. For more information on how to work around knex <a href="https://knex.org/" target="_blank" rel="noopener noreferrer">click here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>First of all, we highly recommend to install knex globally:</p> <div class="language- extra-class"><pre class="language-text"><code>$ npm install knex -g
</code></pre></div><br>
Until now we should have the following Directory Structure:
<div class="language- extra-class"><pre><code>.
├── bin                  
├── node_modules       
├── public   
├── routes
├── views              
├── app.js
├── package-lock.json
└── package.json
</code></pre></div><p>We will add the following:</p> <div class="language- extra-class"><pre><code>.
├── bin
├── database
    ├── migrations       
    └── seeds
        ├── development
        ├── production   
        └──  test
├── node_modules       
├── public   
├── routes
├── views              
├── app.js
├── knexfile.js        
├── knex.js        
├── package-lock.json
└── package.json
</code></pre></div><br> <ul><li>database/migrations/ directory will hold all the migrations (changes) to the database.</li> <li>database/seed/ directory will hold all the seed files. Every subdirectory will hold the seed corresponding to that environment.</li> <li>knex.js Will be the instance to connect to the database.
<br>
Go ahead and create those files</li></ul> <p>Before we continue we need to create a configuration file to let knex know how to interact with the database. We need to create a knexfile.js</p> <div class="language- extra-class"><pre class="language-text"><code>$ touch knexfile.js
</code></pre></div><br>
Add the following code to knexfile.js
<div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token punctuation">{</span>
    client<span class="token operator">:</span> <span class="token string">'pg'</span><span class="token punctuation">,</span>
    connection<span class="token operator">:</span> <span class="token string">'postgres://localhost:5432/test_chinchay'</span><span class="token punctuation">,</span>
    migrations<span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/database/migrations'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    seeds<span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/database/seeds/test'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    acquireConnectionTimeout<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  development<span class="token operator">:</span> <span class="token punctuation">{</span>
    client<span class="token operator">:</span> <span class="token string">'pg'</span><span class="token punctuation">,</span>
    connection<span class="token operator">:</span> <span class="token string">'postgres://localhost:5432/test_chinchay'</span><span class="token punctuation">,</span>
    migrations<span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/database/migrations'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    seeds<span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/database/seeds/development'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    acquireConnectionTimeout<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  production<span class="token operator">:</span> <span class="token punctuation">{</span>
    client<span class="token operator">:</span> <span class="token string">'pg'</span><span class="token punctuation">,</span>
    connection<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">DATABASE_URL</span> <span class="token operator">||</span> <span class="token string">'postgres://localhost:5432/test_chinchay'</span><span class="token punctuation">,</span>
    migrations<span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/database/migrations'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    seeds<span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/database/seeds/production'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    acquireConnectionTimeout<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  staging<span class="token operator">:</span> <span class="token punctuation">{</span>
    client<span class="token operator">:</span> <span class="token string">'pg'</span><span class="token punctuation">,</span>
    connection<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">DATABASE_URL</span> <span class="token operator">||</span> <span class="token string">'postgres://localhost:5432/test_chinchay'</span><span class="token punctuation">,</span>
    migrations<span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/database/migrations'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    seeds<span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/database/seeds/production'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    acquireConnectionTimeout<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p><em>NOTE:</em> If your Postgres user it is not postgres change it accordingly in the connection URL.</p> <p>We will not get in details of how this file works, but basically we are telling knex wjere we want to save the migrations, the seeds and what is the url to connect to the database. Note that the knexfile defines this variables for every environment by separate.</p> <p>Now we need to add the following code to the knex.js file:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> environment <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">||</span> <span class="token string">'development'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./knexfile'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>environment<span class="token punctuation">]</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'knex'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br>
Now knex is configured to connect to the database.
<h2 id="using-chinchay"><a href="#using-chinchay" class="header-anchor">#</a> Using Chinchay</h2> <p>Now its the simple part. But before we need to create one last file:</p> <ul><li>.chainfile.js: This file holds all of the configurations for chinchay.
<br>
Go ahead and create this file.</li></ul> <p>In the .chainfile.js add the following:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  models<span class="token operator">:</span> <span class="token punctuation">{</span>
    directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'models'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">{</span>
    directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'controllers'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  views<span class="token operator">:</span> <span class="token punctuation">{</span>
    directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'views'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  routes<span class="token operator">:</span> <span class="token punctuation">{</span>
    directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'routes'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  knex<span class="token operator">:</span>  path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'knex.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><br>
Here we are defining which directories will hold the models, the controllers, the views and the routes.
<p>Install chinchay:</p> <div class="language- extra-class"><pre class="language-text"><code>$ npm install chinchay -s
$ npm install chinchay -g
</code></pre></div><br>
Installing chinchay globally will allow you to run chinchay CLI.
<p>Lets build a new relation called coffee and the files to create, view, update and delete entries to it:</p> <div class="language- extra-class"><pre class="language-text"><code>$ chinchay new coffee
</code></pre></div><br>
This will create a model, a controllers, views, routes and a knex migration in the directories defined in .chainfile.js.
<p>The migrations will be saved in the directory database/migrations/. The name will vary, as it takes the current date and time to make the file, but it will be appended by an coffee.js</p> <p>In this file insert the following:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span><span class="token function-variable function">up</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">knex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">'coffee'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Incremental id</span>
    table<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notNullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    table<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string">'price'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// created_at and updated_at</span>
    table<span class="token punctuation">.</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">down</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">knex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropTable</span><span class="token punctuation">(</span><span class="token string">'coffee'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><br>
This piece of code will create a relation called coffee within our database with the variables name and price. Also will generate a id and a created_at and updated_at timestamps for every entry. To run this migration:
<div class="language- extra-class"><pre class="language-text"><code>$ knex migrate:latest
</code></pre></div><br> <p>Last but not least, in the app.js file, right after these lines:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> routes<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> users<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>add the following:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> coffee <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/coffee'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> coffeeAPI <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/coffeeAPI'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> coffee<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> coffeeAPI<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br>
This lines makes the app use the routes for the CRUD operations to the coffee relation.
<br>
Now run the app:
```
$ npm start
```
<br>
and visit [localhost:3000/coffee](localhost:3000/coffee)
<p>Click new to create a coffee!</p> <p>Enjoy!</p> <p>For more information to work around Chinchay CLI:</p> <p><a href="https://afontainec.github.io/chinchay/clidocs" target="_blank" rel="noopener noreferrer">See the Command Line Interface Documentation!<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/gettingstarted/angular.html">
        Getting Started: Chinchay + Angular
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.23d6a0c9.js" defer></script><script src="/assets/js/2.6e51adde.js" defer></script><script src="/assets/js/21.efc1f4cc.js" defer></script>
  </body>
</html>
